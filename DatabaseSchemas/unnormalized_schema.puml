@startuml normalized_schema_er

entity Category {
    +id : int [PK]
    name : string
    description : string
}

entity Product {
    +id : int [PK]
    name : string
    price : decimal
    age_limit : int
    category_id : int [FK]
    supplier_id : int [FK]
}

entity Supplier {
    +id : int [PK]
    name : string
    address : string
}

entity Discount {
    +id : int [PK]
    product_id : int [FK]
    category_id : int [FK]
    percent : decimal
    start_date : DateTime
    end_date : DateTime
}

entity Supply {
    +id : int [PK]
    product_id : int [FK]
    supplier_id : int [FK]
    quantity : int
    supply_date : DateTime
    supply_price : decimal
}

entity Customer {
    +id : int [PK]
    name : string
    email : string
    phone : string
    password : string
}

entity Order {
    +id : int [PK]
    customer_id : int [FK]
    order_date : DateTime
    delivery_date : DateTime
    status : string
}

entity OrderItem {
    +id : int [PK]
    order_id : int [FK]
    product_id : int [FK]
    quantity : int
    total_price : decimal
}

entity Cart {
    +id : int [PK]
    customer_id : int [FK]
}

entity CartItem {
    +id : int [PK]
    cart_id : int [FK]
    product_id : int [FK]
    quantity : int
}

entity Review {
    +id : int [PK]
    customer_id : int [FK]
    product_id : int [FK]
    grade : int
    comment : string
}

entity Employee {
    +id : int [PK]
    name : string
    email : string
    phone : string
    password : string
    role : string
    passport_id : string
}

entity Admin {
    +id : int [PK]
    name : string
    email : string
    password : string
}

entity ActivityLog {
    +id : int [PK]
    user_id : int [FK]
    user_type : string
    action : string
    date : DateTime
    time : TimeSpan
}

Category ||--o{ Product : "1:M"
Supplier ||--o{ Product : "1:M"
Product ||--o{ Supply : "1:M"
Supplier ||--o{ Supply : "1:M"

Product ||--o{ Discount : "1:M"
Category ||--o{ Discount : "1:M"

Customer ||--o{ Order : "1:M"
Order ||--o{ OrderItem : "1:M"
Product ||--o{ OrderItem : "1:M"

Customer ||--|| Cart : "1:1"
Cart ||--o{ CartItem : "1:M"
Product ||--o{ CartItem : "1:M"

Customer ||--o{ Review : "1:M"
Product ||--o{ Review : "1:M"

ActivityLog ||--o{ Customer : "M:M"
ActivityLog ||--o{ Employee : "M:M"
ActivityLog ||--o{ Admin : "M:M"

@enduml
